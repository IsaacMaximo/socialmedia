<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image" href="assets/imgs/IconNoBG.svg">
    <link id="temadoSITE" rel="stylesheet" href="lightmode.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tono - Discovery</title>
                        <!-- Fonte !-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
</head>
<body>
    <aside id="menu-lateral">
        <div id="nlogado">
            <button id="loginBtn"><span class="TextoImportante">Entrar com Spotify</span></button>
        </div>
        <div id="logado">
            <div id="perfil-usuario">
                <ul id="ul-PerfildoUsuario">
                    <img class="ImgUser" src="assets/imgs/Users.svg" alt="IMG_error">
                    <li id="ul-perfil-usuario">
                        <ul id="ul-PerfildoUsuario-Escrita">
                            <li id="li-PerfildoUsuario-Nome">
                                <span class="UserName" id="Nome_do_Usuario">User</span>
                            </li>

                            <li id="li-PerfildoUsuario-Arroba">
                                <span class="Texto2" id="Id_do_Usuario">@User-Id</span>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        
        <div id="itens-menu-lateral">
            <ul id="ul-itens-menu-lateral">
                
                
                <li id="li-ul-Aba-Comunidade">
                    <button>
                        <ul class="ul-Aba" id="ul-Aba-Comunidade">
                            <img class="img-Aba" src="assets/imgs/Users.svg" alt="">
                            <span class="TextoImportante" id="span-Comunidade">Comunidade</span>
                        </ul>
                    </button>
                </li>

                <li id="li-ul-Aba-Mensagens">
                    <button>
                        <ul class="ul-Aba" id="ul-Aba-Mensagens">
                            <img class="img-Aba" src="assets/imgs/Message circle.svg" alt="">
                            <span class="TextoImportante" id="span-Mensagens">Mensagens</span>
                        </ul>
                    </button>
                </li>

                <li id="li-ul-Aba-Discovery">
                    <button>
                        <ul class="ul-Aba" id="ul-Aba-Discovery">
                            <img class="img-Aba" src="assets/imgs/Compas.svg" alt="">
                            <span class="TextoImportante" id="span-Discovery">Discovery</span>
                        </ul>
                    </button>
                </li>

                <li id="li-ul-Aba-Playlists">
                    <button>
                        <ul class="ul-Aba" id="ul-Aba-Playlists">
                            <img class="img-Aba" src="assets/imgs/Playlist.svg" alt="">
                            <span class="TextoImportante" id="span-Playlists">Playlists</span>
                        </ul>
                    </button>
                </li> 

                <li id="li-ul-Aba-Projeto">
                    <button>
                        <ul class="ul-Aba" id="ul-Aba-Projeto">
                            <img class="img-Aba" src="assets/imgs/Info circle.svg" alt="">
                            <span class="TextoImportante" id="span-Projeto">Projeto</span>
                        </ul>
                    </button>
                </li>

                <li id="li-info-PAP">
                    <span class="Texto2" id="span-info-pap">Trabalho teste para PAP(Prova de Aptidão Profissional)</span>

                </li>

                <li id="li-info-vers">
                    <span class="Textoinfo" id="span-info-vers">v0.01</span>
                </li>

            </ul>
        </div>
    </aside>

    
        <main id="content1">
            <nav id="pesquisa">
                <input class="TextoPesquisa" id="search-bar" type="text" placeholder="Pesquisa v0.01">
            </nav>
            <br>
                <span class="TextoTitulo">Músicas Recomendadas:</span>
                <br>
                <span class="TextoPesquisa">Recomendadas com base nos artistas que você segue</span>
                <ul id="content-do-search">
                    <div class="recomenda-base">
                        a
                    </div>
                    <div class="recomenda-base">
                        b
                    </div>
                    <div class="recomenda-base">
                        c
                    </div>
                    <div class="recomenda-base">
                        d
                    </div>
                    <div class="recomenda-base">
                        e
                    </div>
                    <div class="recomenda-base">
                        f
                    </div>
                </ul>
        </main>







        <div id="aba-direita">
            <nav id="menu-aba-direita">
                <button>
                    <img class="img-Aba" src="assets/imgs/Home.svg" alt="">
                </button>
                <button>
                    <img class="img-Aba" src="assets/imgs/Coração.svg" alt="">
                </button>
                <button>
                    <img class="img-Aba" src="assets/imgs/Mail.svg" alt="">
                </button>
                <button>
                    <img class="img-Aba" src="assets/imgs/Settings.svg" alt="">
                </button>
            </nav>
            <span class="TextoPesquisa">Sugestões para seguir</span>
            
                <div id="boxpseguir">

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>

                    <div class="Pseguir">
                        <ul class="img-perfilseguir">
                            <img src="assets/imgs/user-avatar.png" alt="">
                        </ul>
                        <ul class="escrita-perfilseguir">
                            <span class="UserName">TesteNome</span>
                            <span class="Texto2">TesteArroba</span>
                        </ul>
                    </div>


                </div>
        </div>









    <footer>
        <ul id="InfoMusica">
            <li><img id="Musica-Imagem" src="assets/imgs/Music plate.svg" alt=""></li>
            <li><ul>
                <li id="Musica-Nome">
                    <span class="UserName" id="Musica-Nome-span">Artista</span>
                </li>
                <li id="Musica-Artista">
                    <span class="Texto2" id="Musica-Artista-span">Musica</span>
                </li>
            </li></ul>
            </ul>
        <nav id="Player-Musica">

            <audio id="musica-audio" src=""></audio>

            <ul class="BotoesMusica-Default">
                <li class="MusicaBotao">
                    <button id="Player-Musica-Botao-Anterior-btn">
                        <img class="BotoesMusica-Default-img" src="assets/imgs/anterior.svg" alt="">
                    </button>
                </li>
                <li class="MusicaBotao">
                    <button id="Player-Musica-Botao-Play-btn">
                        <img class="BotoesMusica-Default-img" id="Player-Musica-Botao-Play-btn-img" src="assets/imgs/Play.svg" alt="">
                    </button>
                </li>
                <li class="MusicaBotao" >
                    <button id="Player-Musica-Botao-Seguinte-btn">
                        <img class="BotoesMusica-Default-img" src="assets/imgs/seguinte.svg" alt="">
                    </button>
                </li>
                <li class="MusicaBotao">
                    <button id="Player-Musica-Botao-Retry-btn">
                        <img class="BotoesMusica-Default-img" src="assets/imgs/retry.svg" alt="">
                    </button>
                </li>
                <li class="MusicaBotao">
                    <button id="Player-Musica-Botao-Aleatorio-btn">
                        <img class="BotoesMusica-Default-img" src="assets/imgs/Swap.svg" alt="">
                    </button>
                </li>
            </ul>
            
            
            <ul id="Player-Musica-Botao-ProgressiveBar-ul">
                <li>
                    <span class="TextoImportante" id="ProgressiveBar-Tempo-Atual">--:--</span>
                </li>
                <li>
                    <div id="ProgressiveBar-container">
                        <div id="Player-Musica-Botao-ProgressiveBar-div"></div>
                    </div>
                </li>
                <li>
                    <span class="TextoImportante" id="ProgressiveBar-Tempo-Total">--:--</span>
                </li>
            </ul>
            
            <ul class="BotoesMusica-Default">
                <li class="MusicaBotao" id="Player-Musica-Botao-Volume">
                    <button id="btn-volume">
                        <img id="volume-icon" class="BotoesMusica-Default-img" src="assets/imgs/Volume down.svg" alt="">
                    </button>
                    <div id="slider-div">
                        <input type="range" id="volume-slider" min="0" max="1" step="0.007" value=".5">
                    </div>
                </li>
                <li class="MusicaBotao" id="Player-Musica-Botao-Favoritos">
                    <button>
                        <img class="BotoesMusica-Default-img" src="assets/imgs/Coração.svg" alt="">
                    </button>
                    </li>
                <li class="MusicaBotao" id="Player-Musica-Botao-Partilhar">
                    <button>
                        <img class="BotoesMusica-Default-img" src="assets/imgs/Share.svg" alt="">
                    </button>
                    </li>
                <li class="MusicaBotao" id="Player-Musica-Botao-AddPlaylist">
                    <button>
                        <img class="BotoesMusica-Default-img" src="assets/imgs/Receipt.svg" alt="">
                    </button>
                    </li>
            </ul>
        </nav>
    </footer>
</body>
<script>
    console.log("DESLOGAR -> localStorage.removeItem('spotify_access_token');")
</script>

<script type="module" src="http://localhost/socialmedia/api/OAuth.js"></script>
<script src="http://localhost/socialmedia/api/chatmusicaglobal.js"></script>
<script type="module" src="http://localhost/socialmedia/api/login.js"></script>
<script src="botoes.js"></script>



<script type="module">
    import { PesquisaSpotify } from './SpotifySearch.js';

    document.addEventListener('DOMContentLoaded', () => {
        const searchInput = document.getElementById('search-bar');
        const resultsContainer = document.getElementById('content-do-search');

        if (!searchInput || !resultsContainer) {
            console.error('Elementos não encontrados');
            return;
        }

        searchInput.addEventListener('keydown', async (event) => {
            if (event.key === 'Enter') {
                const query = searchInput.value.trim();
                
                if (!query) {
                    resultsContainer.innerHTML = '<p style="color:#666">Invalido</p>';
                    return;
                }

                try {
                    resultsContainer.innerHTML = '<p style="color:#1DB954; cursor: wait;">Pesquisando...</p>';
                    const tracks = await PesquisaSpotify(query, 5);
                    
                    if (tracks?.length > 0) {
                        resultsContainer.innerHTML = tracks.map(track => `
                            <div style="margin-bottom:15px;">
                                <div class="Musicas-do-search">
                                    <strong>${track.name}</strong><br>
                                    <small>Artista: ${track.artists.map(a => a.name).join(', ')}</small><br>
                                    <small>Álbum: ${track.album.name}</small>
                                    
                                    ${track.preview_url ? 
                                        `<div style="margin-top:5px">
                                            <audio controls src="${track.preview_url}" style="width:100%"></audio>
                                            <iframe src="https://open.spotify.com/embed/track/${track.id}" width="300" height="80" frameborder="0"></iframe>
                                        </div>` : 

                                        '<div style="color:#888;font-size:smaller">Prévia não disponível</div>'}
                                        <div class="musica" data-id="${track.id}">
                                            <button class="botao-forum" onclick="abrirchatgeral('${track.id}')">CLICK</button>
                                        </div>
                            </div>
                        `).join('');
                    } else {
                        resultsContainer.innerHTML = '<p style="color:#666">Nenhum resultado encontrado</p>';
                    }
                } catch (error) {
                    console.error('Erro na pesquisa:');
                    resultsContainer.innerHTML = `
                        <div style="color:red">
                            Erro: ${error.message || 'Falha na pesquisa'}
                        </div>
                        ${localStorage.getItem('spotify_access_token') ? '' : 
                         '<div style="color:orange">Faça login no Spotify primeiro</div>'}
                    `;
                }
            }
        });

        searchInput.focus();
    });
</script>

</html>